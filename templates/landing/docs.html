{% extends 'base.html' %}
{% block title %}Developer Documentation - NexaPay{% endblock %}
{% block content %}
<nav class="fixed top-0 w-full z-50 glass">
    <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
        <a href="/" class="text-2xl font-bold gradient-text">NexaPay</a>
        <div class="flex items-center space-x-6">
            <a href="/" class="text-gray-300 hover:text-white transition">Home</a>
            <a href="{% url 'accounts:login' %}" class="text-gray-300 hover:text-white transition">Login</a>
        </div>
    </div>
</nav>

<div class="pt-28 pb-20 px-6 max-w-5xl mx-auto fade-in">
    <h1 class="text-4xl md:text-5xl font-bold mb-4 gradient-text">Developer Documentation</h1>
    <p class="text-gray-400 text-lg mb-12">Everything you need to integrate NexaPay into your application.</p>

    <div class="space-y-8">
        <div class="glass rounded-2xl p-8">
            <h2 class="text-2xl font-bold text-white mb-4">1. Getting Started</h2>
            <ol class="list-decimal list-inside space-y-2 text-gray-300">
                <li>Create a NexaPay business account</li>
                <li>Generate your API keys from the Dashboard</li>
                <li>Use the Public Key to authenticate API requests</li>
                <li>Save the Secret Key securely for webhook verification</li>
            </ol>
        </div>

        <div class="glass rounded-2xl p-8">
            <h2 class="text-2xl font-bold text-white mb-4">2. Create Payment API</h2>
            <div class="bg-black/50 rounded-xl p-4 mb-4">
                <p class="text-green-400 font-mono text-sm mb-2">POST {{ base_url }}/api/create-payment/</p>
                <p class="text-gray-400 font-mono text-sm">Authorization: Bearer YOUR_PUBLIC_KEY</p>
            </div>
            <h3 class="text-white font-semibold mb-2">Request Body (JSON)</h3>
            <pre class="bg-black/50 rounded-xl p-4 text-sm text-gray-300 overflow-x-auto"><code>{
  "amount": 1000,
  "currency": "INR",
  "customer_name": "John Doe",
  "customer_email": "john@example.com",
  "callback_url": "https://yoursite.com/webhook"
}</code></pre>
            <h3 class="text-white font-semibold mt-4 mb-2">Response</h3>
            <pre class="bg-black/50 rounded-xl p-4 text-sm text-gray-300 overflow-x-auto"><code>{
  "success": true,
  "payment_id": "uuid-here",
  "payment_url": "{{ base_url }}/payment/uuid-here/",
  "amount": "1000.00",
  "currency": "INR",
  "status": "created"
}</code></pre>
        </div>

        <div class="glass rounded-2xl p-8">
            <h2 class="text-2xl font-bold text-white mb-4">3. Python SDK</h2>
            <pre class="bg-black/50 rounded-xl p-4 text-sm text-gray-300 overflow-x-auto"><code>pip install nexapay</code></pre>
            <pre class="bg-black/50 rounded-xl p-4 text-sm text-gray-300 overflow-x-auto mt-3"><code>import nexapay

client = nexapay.Client(public_key="your_public_key")

payment = client.create_payment(
    amount=1000,
    currency="INR",
    customer_name="John Doe",
    customer_email="john@example.com"
)

print(payment["payment_url"])</code></pre>
        </div>

        <div class="glass rounded-2xl p-8">
            <h2 class="text-2xl font-bold text-white mb-4">4. Node.js Example</h2>
            <pre class="bg-black/50 rounded-xl p-4 text-sm text-gray-300 overflow-x-auto"><code>const response = await fetch('{{ base_url }}/api/create-payment/', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer YOUR_PUBLIC_KEY'
  },
  body: JSON.stringify({
    amount: 1000,
    currency: 'INR',
    customer_name: 'John Doe',
    customer_email: 'john@example.com'
  })
});

const data = await response.json();
console.log(data.payment_url);</code></pre>
        </div>

        <div class="glass rounded-2xl p-8">
            <h2 class="text-2xl font-bold text-white mb-4">5. React Example</h2>
            <pre class="bg-black/50 rounded-xl p-4 text-sm text-gray-300 overflow-x-auto"><code>async function createPayment() {
  const res = await fetch('{{ base_url }}/api/create-payment/', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': 'Bearer YOUR_PUBLIC_KEY'
    },
    body: JSON.stringify({ amount: 500, currency: 'INR' })
  });
  const data = await res.json();
  window.location.href = data.payment_url;
}</code></pre>
        </div>

        <div class="glass rounded-2xl p-8">
            <h2 class="text-2xl font-bold text-white mb-4">6. Java Spring Boot Example</h2>
            <pre class="bg-black/50 rounded-xl p-4 text-sm text-gray-300 overflow-x-auto"><code>RestTemplate restTemplate = new RestTemplate();
HttpHeaders headers = new HttpHeaders();
headers.set("Authorization", "Bearer YOUR_PUBLIC_KEY");
headers.setContentType(MediaType.APPLICATION_JSON);

Map&lt;String, Object&gt; body = Map.of(
    "amount", 1000,
    "currency", "INR",
    "customer_name", "John Doe"
);

HttpEntity&lt;Map&gt; request = new HttpEntity&lt;&gt;(body, headers);
ResponseEntity&lt;Map&gt; response = restTemplate.postForEntity(
    "{{ base_url }}/api/create-payment/",
    request, Map.class
);

System.out.println(response.getBody().get("payment_url"));</code></pre>
        </div>

        <div class="glass rounded-2xl p-8">
            <h2 class="text-2xl font-bold text-white mb-4">7. Webhook Verification</h2>
            <p class="text-gray-300 mb-4">When a payment succeeds, NexaPay sends a POST to your callback_url with an HMAC signature.</p>
            <pre class="bg-black/50 rounded-xl p-4 text-sm text-gray-300 overflow-x-auto"><code>import hmac, hashlib, json

def verify_webhook(payload, received_signature, secret_key):
    signature_payload = {
        "payment_id": payload["payment_id"],
        "amount": payload["amount"],
        "status": payload["status"]
    }
    expected = hmac.new(
        secret_key.encode(),
        json.dumps(signature_payload, sort_keys=True).encode(),
        hashlib.sha256
    ).hexdigest()
    return hmac.compare_digest(expected, received_signature)</code></pre>
        </div>
    </div>
</div>

<footer class="py-8 px-6 border-t border-gray-800 text-center text-gray-500 text-sm">
    NexaPay. All rights reserved.
</footer>
{% endblock %}
